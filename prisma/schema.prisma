generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Player {
  id              Int            @id @default(autoincrement())
  characterInfoId Int            
  levelInfoId     Int           
  nickName        String         @unique

  exp             Int            @default(0)
  score           Int            @default(0)
  equippedItems   EquippedItem[]
  inventory       Inventory[]
  characterInfo   CharacterInfo  @relation(fields: [characterInfoId], references: [id])
  levelInfo     LevelInfo      @relation(fields: [levelInfoId], references: [id])

  @@map("Player")
}

model CharacterInfo {
  id      Int     @id
  name    String  @unique
  health  Int     @default(10)
  mana    Int     @default(10)
  attack  Int     @default(1)
  defence Int     @default(1)
  agility Int     @default(1)
  speed   Int     @default(1)
  player  Player[]

  @@map("CharacterInfo")
}

model Inventory {
  id       Int    @id @default(autoincrement())
  playerId Int
  itemId   Int
  item     Item   @relation(fields: [itemId], references: [id])
  player   Player @relation(fields: [playerId], references: [id])

  @@index([itemId], map: "Inventory_itemId_fkey")
  @@index([playerId], map: "Inventory_playerId_fkey")
  @@map("Inventory")
}

model Item {
  id            Int            @id
  name          String
  itemType      ItemType
  equipSlot     EquipSlot?
  health        Int            @default(0)
  mana          Int            @default(0)
  attack        Int            @default(0)
  defence       Int            @default(0)
  agility       Int            @default(0)
  speed         Int            @default(0)
  equippedItems EquippedItem[]
  inventories   Inventory[]

  @@map("Item")
}

model EquippedItem {
  playerId Int
  itemId   Int
  item     Item   @relation(fields: [itemId], references: [id])
  player   Player @relation(fields: [playerId], references: [id])

  @@id([playerId, itemId])
  @@index([itemId], map: "EquippedItem_itemId_fkey")
  @@map("EquippedItem")
}

model MonsterInfo {
  id       Int       @id
  name     String    @unique
  health   Int       @default(1)
  mana     Int       @default(1)
  attack   Int       @default(1)
  defence  Int       @default(1)
  agility  Int       @default(1)
  speed    Int       @default(1)

  @@map("MonsterInfo")
}

model Stage {
  id            Int              @id
  stageLevel    Int              @default(1)
  stageExp      Int              @default(5)
  spawn         Int              @default(1)
  monsterLevel Int           @default(1)

  @@map("Stage")
}



model LevelInfo {
  id          Int @id
  level       Int
  statPoints  Int @default(1)
  requiredExp Int

  player Player[]

  @@map("LevelInfo")
}

enum ItemType {
  EQUIP
  CONSUME
}

enum EquipSlot {
  NONE
  HEAD
  BODY
  WEAPON
  SHIELD
  RING
  NECKLACE
}
